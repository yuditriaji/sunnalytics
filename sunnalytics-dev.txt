
=== .\.gitignore ===
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

=== .\all_files_combined.txt ===

=== .\eslint.config.mjs ===
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals", "next/typescript"),
];

export default eslintConfig;

=== .\next-env.d.ts ===
/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/pages/building-your-application/configuring/typescript for more information.

=== .\next.config.js ===
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
  disable: process.env.NODE_ENV === 'development' // Disable PWA in dev for faster reloads
});

const nextConfig = {
  reactStrictMode: true,
  swcMinify: true, // Enable SWC minification for faster builds
  images: {
    domains: ['localhost'], // Add domains for image optimization if needed
  },
  experimental: {
    optimizePackageImports: ['antd', '@ant-design/icons'], // Optimize Ant Design imports
  },
};

module.exports = withPWA(nextConfig);
=== .\package.json ===
{
  "name": "sunnalytics-dev",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "format": "prettier --write \"**/*.{ts,tsx,js,jsx}\""
  },
  "dependencies": {
    "chart.js": "^4.4.9",
    "framer-motion": "^12.14.0",
    "localforage": "^1.10.0",
    "next": "^14.2.29",
    "next-pwa": "^5.6.0",
    "react": "^18.3.1",
    "react-chartjs-2": "^5.3.0",
    "react-dom": "^18.3.1",
    "react-icons": "^5.5.0",
    "react-responsive": "^10.0.1",
    "react-window": "^1.8.11",
    "swr": "^2.2.5",
    "tailwindcss": "^3.4.1",
    "zustand": "^5.0.0-rc.2"
  },
  "devDependencies": {
    "@types/lodash.debounce": "^4.0.9",
    "@types/node": "^22.7.7",
    "@types/react": "^18.3.11",
    "@types/react-dom": "^18.3.1",
    "@types/react-window": "^1.8.8",
    "autoprefixer": "^10.4.19",
    "eslint": "^8.57.1",
    "eslint-config-next": "^14.2.29",
    "postcss": "^8.4.38",
    "prettier": "^3.3.3",
    "typescript": "^5.6.3"
  }
}

=== .\postcss.config.js ===
module.exports = {
plugins: {
    tailwindcss: {},
    autoprefixer: {},
},
};
=== .\tailwind.config.js ===
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./pages/**/*.{js,ts,jsx,tsx}",
    "./components/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
};
=== .\tree.txt ===
Project Tree (excluding node_modules, .next, package-lock.json):

â”œâ”€â”€ .env
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ all_files_combined.txt
â”œâ”€â”€ combine_files.py
â”œâ”€â”€ components
â”‚   â”œâ”€â”€ BottomNav.tsx
â”‚   â”œâ”€â”€ FilterDrawer.tsx
â”‚   â”œâ”€â”€ TokenTable.tsx
â”‚   â””â”€â”€ WelcomeScreen.tsx
â”œâ”€â”€ eslint.config.mjs
â”œâ”€â”€ generate_tree.py
â”œâ”€â”€ hooks
â”‚   â””â”€â”€ useTokenData.ts
â”œâ”€â”€ next-env.d.ts
â”œâ”€â”€ next.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ pages
â”‚   â”œâ”€â”€ _app.tsx
â”‚   â”œâ”€â”€ api
â”‚   â”œâ”€â”€ charts.tsx
â”‚   â”œâ”€â”€ index.tsx
â”‚   â”œâ”€â”€ settings.tsx
â”‚   â””â”€â”€ welcome.tsx
â”œâ”€â”€ postcss.config.js
â”œâ”€â”€ src
â”œâ”€â”€ stores
â”‚   â””â”€â”€ useTokenStore.ts
â”œâ”€â”€ styles
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ tree.txt
â”œâ”€â”€ tsconfig.json
â””â”€â”€ utils
    â”œâ”€â”€ api.ts
    â”œâ”€â”€ fonts.ts
    â””â”€â”€ tokenStats.ts
=== .\tsconfig.json ===
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts", "postcss.config.js"],
  "exclude": ["node_modules"]
}

=== .\components\BottomNav.tsx ===
import React from 'react';
import { useRouter } from 'next/router';
import { FaChartLine, FaFilter, FaWallet, FaHome } from 'react-icons/fa';

interface BottomNavProps {
  onFilterClick?: () => void;
}

const BottomNav: React.FC<BottomNavProps> = ({ onFilterClick }) => {
  const router = useRouter();

  return (
    <nav className="fixed bottom-0 left-0 right-0 bg-gray-800 h-20 p-2 flex justify-around items-center border-t border-gray-700 shadow-lg pb-safe-area-inset-bottom">
      <button
        onClick={() => router.push('/')}
        className={`flex flex-col items-center text-xs ${
          router.pathname === '/' ? 'text-yellow-400' : 'text-gray-400'
        } hover:text-yellow-400 transition-all duration-200 hover:scale-110`}
      >
        <FaHome className="text-lg mb-1" />
        <span>Market</span>
      </button>
      <button
        onClick={() => router.push('/portfolio')}
        className={`flex flex-col items-center text-xs ${
          router.pathname === '/portfolio' ? 'text-yellow-400' : 'text-gray-400'
        } hover:text-yellow-400 transition-all duration-200 hover:scale-110`}
      >
        <FaWallet className="text-lg mb-1" />
        <span>Portfolio</span>
      </button>
      <button
        onClick={onFilterClick}
        className="flex flex-col items-center text-xs text-gray-400 hover:text-yellow-400 transition-all duration-200 hover:scale-110"
      >
        <FaFilter className="text-lg mb-1" />
        <span>Filter</span>
      </button>
      <button
        onClick={() => router.push('/charts')}
        className={`flex flex-col items-center text-xs ${
          router.pathname === '/charts' ? 'text-yellow-400' : 'text-gray-400'
        } hover:text-yellow-400 transition-all duration-200 hover:scale-110`}
      >
        <FaChartLine className="text-lg mb-1" />
        <span>Charts</span>
      </button>
    </nav>
  );
};

export default BottomNav;
=== .\components\FilterDrawer.tsx ===
import React, { useState, useEffect } from 'react';
import { useTokenStore } from '../stores/useTokenStore';

interface FilterDrawerProps {
  isOpen: boolean;
  onClose: () => void;
}

const FilterDrawer: React.FC<FilterDrawerProps> = ({ isOpen, onClose }) => {
  const { filteredTokens, setFilteredTokens, tokens } = useTokenStore();
  const [filters, setFilters] = useState({
    category: '',
    minPrice: '',
    maxPrice: '',
    minVolumeMarketCapRatio: '',
    maxVolumeMarketCapRatio: '',
    minCirculatingSupplyPercentage: '',
    maxCirculatingSupplyPercentage: '',
    isVolumeHealthy: '',
    isCirculatingSupplyGood: '',
  });

  useEffect(() => {
    const applyFilters = () => {
      let filtered = [...tokens];
      if (filters.category) {
        filtered = filtered.filter(token => token.category === filters.category);
      }
      if (filters.minPrice) {
        const min = parseFloat(filters.minPrice);
        filtered = filtered.filter(token => token.price !== undefined && token.price >= min);
      }
      if (filters.maxPrice) {
        const max = parseFloat(filters.maxPrice);
        filtered = filtered.filter(token => token.price !== undefined && token.price <= max);
      }
      if (filters.minVolumeMarketCapRatio) {
        const min = parseFloat(filters.minVolumeMarketCapRatio) / 100; // Convert percentage to ratio
        filtered = filtered.filter(token => token.volumeMarketCapRatio !== undefined && token.volumeMarketCapRatio >= min);
      }
      if (filters.maxVolumeMarketCapRatio) {
        const max = parseFloat(filters.maxVolumeMarketCapRatio) / 100; // Convert percentage to ratio
        filtered = filtered.filter(token => token.volumeMarketCapRatio !== undefined && token.volumeMarketCapRatio <= max);
      }
      if (filters.minCirculatingSupplyPercentage) {
        const min = parseFloat(filters.minCirculatingSupplyPercentage);
        filtered = filtered.filter(token => token.circulatingSupplyPercentage !== undefined && token.circulatingSupplyPercentage >= min);
      }
      if (filters.maxCirculatingSupplyPercentage) {
        const max = parseFloat(filters.maxCirculatingSupplyPercentage);
        filtered = filtered.filter(token => token.circulatingSupplyPercentage !== undefined && token.circulatingSupplyPercentage <= max);
      }
      if (filters.isVolumeHealthy === 'true') {
        filtered = filtered.filter(token => token.isVolumeHealthy === true);
      } else if (filters.isVolumeHealthy === 'false') {
        filtered = filtered.filter(token => token.isVolumeHealthy === false);
      }
      if (filters.isCirculatingSupplyGood === 'true') {
        filtered = filtered.filter(token => token.isCirculatingSupplyGood === true);
      } else if (filters.isCirculatingSupplyGood === 'false') {
        filtered = filtered.filter(token => token.isCirculatingSupplyGood === false);
      }
      setFilteredTokens(filtered);
    };

    applyFilters();
  }, [filters, tokens, setFilteredTokens]);

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {
    const { name, value } = e.target;
    setFilters(prev => ({ ...prev, [name]: value }));
  };

  const handleReset = () => {
    setFilters({
      category: '',
      minPrice: '',
      maxPrice: '',
      minVolumeMarketCapRatio: '',
      maxVolumeMarketCapRatio: '',
      minCirculatingSupplyPercentage: '',
      maxCirculatingSupplyPercentage: '',
      isVolumeHealthy: '',
      isCirculatingSupplyGood: '',
    });
    setFilteredTokens(tokens);
  };

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50">
      <div className="bg-gray-800 w-full max-w-md p-4 rounded-t-lg">
        <h2 className="text-lg font-bold text-white mb-4">Filter Tokens</h2>
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-300">Category</label>
            <select
              name="category"
              value={filters.category}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
            >
              <option value="">All</option>
              <option value="altcoin">Altcoin</option>
              <option value="defi">DeFi</option>
              <option value="memecoin">Memecoin</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Min Price ($)</label>
            <input
              type="number"
              name="minPrice"
              value={filters.minPrice}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
              placeholder="0.00"
              min="0"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Max Price ($)</label>
            <input
              type="number"
              name="maxPrice"
              value={filters.maxPrice}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
              placeholder="0.00"
              min="0"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Min Volume Market Cap Ratio (%)</label>
            <input
              type="number"
              name="minVolumeMarketCapRatio"
              value={filters.minVolumeMarketCapRatio}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
              placeholder="0.00"
              min="0"
              step="0.01"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Max Volume Market Cap Ratio (%)</label>
            <input
              type="number"
              name="maxVolumeMarketCapRatio"
              value={filters.maxVolumeMarketCapRatio}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
              placeholder="100.00"
              min="0"
              step="0.01"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Min Circulating Supply (%)</label>
            <input
              type="number"
              name="minCirculatingSupplyPercentage"
              value={filters.minCirculatingSupplyPercentage}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
              placeholder="0.00"
              min="0"
              step="0.01"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Max Circulating Supply (%)</label>
            <input
              type="number"
              name="maxCirculatingSupplyPercentage"
              value={filters.maxCirculatingSupplyPercentage}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
              placeholder="100.00"
              min="0"
              step="0.01"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Is Volume Healthy</label>
            <select
              name="isVolumeHealthy"
              value={filters.isVolumeHealthy}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
            >
              <option value="">All</option>
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300">Is Circulating Supply Good</label>
            <select
              name="isCirculatingSupplyGood"
              value={filters.isCirculatingSupplyGood}
              onChange={handleChange}
              className="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"
            >
              <option value="">All</option>
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
        </div>
        <div className="mt-6 flex justify-end space-x-4">
          <button
            onClick={handleReset}
            className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-500 transition-colors"
          >
            Reset
          </button>
          <button
            onClick={onClose}
            className="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-400 transition-colors"
          >
            Apply
          </button>
        </div>
      </div>
    </div>
  );
};

export default FilterDrawer;
=== .\components\TabbedFilters.tsx ===
// components/TabbedFilters.tsx
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useTokenStore } from '../stores/useTokenStore';

const tabs = [
  { id: 'all', label: 'All' },
  { id: 'highlights', label: 'Highlights', badge: 'ðŸ”¥' },
  { id: 'trending', label: 'Trending', badge: 'ðŸ“ˆ' },
  { id: 'pumpfun', label: 'Pump.fun' },
  { id: 'ecosystems', label: 'Ecosystems' },
];

const TabbedFilters: React.FC = () => {
  const { setFilteredTokens, tokens } = useTokenStore();
  const [activeTab, setActiveTab] = useState('all');

  const handleTabClick = (tabId: string) => {
    setActiveTab(tabId);
    if (tabId === 'all') {
      setFilteredTokens(tokens);
    } else {
      setFilteredTokens(tokens.filter(token => token.category.toLowerCase() === tabId));
    }
  };

  return (
    <div className="mb-4">
      <div
        className="flex space-x-2 overflow-x-auto pb-2"
        role="tablist"
        aria-label="Token Categories"
      >
        {tabs.map(tab => (
          <button
            key={tab.id}
            onClick={() => handleTabClick(tab.id)}
            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
              activeTab === tab.id
                ? 'bg-yellow-500 text-black'
                : 'bg-gray-700 text-white hover:bg-gray-600'
            }`}
            role="tab"
            aria-selected={activeTab === tab.id}
            aria-controls={`panel-${tab.id}`}
          >
            {tab.label}
            {tab.badge && <span className="ml-1">{tab.badge}</span>}
          </button>
        ))}
      </div>
      <AnimatePresence>
        <motion.div
          key={activeTab}
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -10 }}
          transition={{ duration: 0.3 }}
          id={`panel-${activeTab}`}
          role="tabpanel"
          aria-labelledby={activeTab}
        >
          {/* Content managed by TokenTable */}
        </motion.div>
      </AnimatePresence>
    </div>
  );
};

export default TabbedFilters;
=== .\components\TokenTable.tsx ===
// components/TokenTable.tsx
import React, { useState, useMemo, memo, useCallback } from 'react';
import { useTokenStore } from '../stores/useTokenStore';
import FilterDrawer from './FilterDrawer';
import { FaSort } from 'react-icons/fa';
import { FixedSizeList } from 'react-window';
import debounce from 'lodash.debounce';

interface Token {
  name: string;
  symbol: string;
  category: string;
  price?: number;
  marketCap?: number;
  volume24h?: number;
  transferVolume24h?: number;
  fullyDilutedValuation?: number;
  volumeMarketCapRatio?: number;
  circulatingSupplyPercentage?: number;
  isVolumeHealthy?: boolean;
  isCirculatingSupplyGood?: boolean;
  potentialMultiplier?: number;
  rank?: number;
  liquidityScore?: number;
  pumpDumpRiskScore?: number;
  walletDistributionScore?: number;
}

interface TokenTableProps {
  isFilterDrawerOpen: boolean;
  onFilterClick: () => void;
  onFilterClose: () => void;
}

const TokenTable: React.FC<TokenTableProps> = memo(({ isFilterDrawerOpen, onFilterClick, onFilterClose }) => {
  const { filteredTokens, setFilteredTokens, tokens } = useTokenStore();
  const [searchQuery, setSearchQuery] = useState('');
  const [visibleColumns, setVisibleColumns] = useState<string[]>([
    'symbol',
    'price',
    'volume24h',
    'marketCap',
    'volumeMarketCapRatio',
    'isVolumeHealthy',
    'pumpDumpRiskScore',
    'liquidityScore',
    'walletDistributionScore',
  ]);
  const [isColumnModalVisible, setIsColumnModalVisible] = useState(false);
  const [isSortModalVisible, setIsSortModalVisible] = useState(false);
  const [sortConfig, setSortConfig] = useState<{ key: string; direction: 'asc' | 'desc' } | null>(null);

  const toggleColumn = (key: string) => {
    setVisibleColumns(prev =>
      prev.includes(key) ? prev.filter(col => col !== key) : [...prev, key]
    );
  };

  const debouncedSearch = useCallback(
    debounce((query: string) => {
      setFilteredTokens(
        tokens.filter(
          token =>
            token.name.toLowerCase().includes(query.toLowerCase()) ||
            token.symbol.toLowerCase().includes(query.toLowerCase())
        )
      );
    }, 300),
    [tokens, setFilteredTokens]
  );

  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const query = e.target.value;
    setSearchQuery(query);
    debouncedSearch(query);
  };

  const showColumnModal = () => {
    setIsColumnModalVisible(true);
  };

  const handleColumnClose = () => {
    setIsColumnModalVisible(false);
  };

  const showSortModal = () => {
    setIsSortModalVisible(true);
  };

  const handleSortClose = () => {
    setIsSortModalVisible(false);
  };

  const requestSort = (key: string) => {
    setSortConfig(prev => {
      if (!prev || prev.key !== key) {
        return { key, direction: 'asc' };
      }
      return prev.direction === 'asc' ? { key, direction: 'desc' } : null;
    });
    handleSortClose();
  };

  const sortedTokens = useMemo(() => {
    if (!sortConfig) return filteredTokens;
    return [...filteredTokens].sort((a, b) => {
      const aValue = a[sortConfig.key as keyof Token];
      const bValue = b[sortConfig.key as keyof Token];
      if (aValue === undefined || bValue === undefined) return 0;
      if (sortConfig.direction === 'asc') {
        return aValue > bValue ? 1 : -1;
      }
      return aValue < bValue ? 1 : -1;
    });
  }, [filteredTokens, sortConfig]);

  const columns = [
    'symbol',
    'price',
    'volume24h',
    'marketCap',
    'volumeMarketCapRatio',
    'isVolumeHealthy',
    'pumpDumpRiskScore',
    'liquidityScore',
    'walletDistributionScore',
  ].filter(col => visibleColumns.includes(col));

  const formatNumber = (value: number | undefined, suffix: string = '') => {
    if (value === undefined || value === 0) return '-';
    if (value >= 1e9) return `$${Math.floor(value / 1e9)}${suffix}B`;
    if (value >= 1e6) return `$${Math.floor(value / 1e6)}${suffix}M`;
    return `$${value.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 6 })}`;
  };

  const formatRatio = (value: number | undefined) => value !== undefined ? `${(value * 100).toFixed(2)}%` : '-';
  const formatBoolean = (value: boolean | undefined) => value !== undefined ? (value ? 'Yes' : 'No') : '-';
  const formatScore = (value: number | undefined) => value !== undefined ? value.toFixed(2) : '-';

  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => {
    const token = sortedTokens[index];
    return (
      <div
        style={style}
        className="bg-gray-800 p-2 flex items-center space-x-4 text-white rounded shadow-sm hover:bg-gray-700 transition-colors"
        role="row"
        aria-label={`Token ${token.symbol}`}
      >
        {columns.map(col => (
          <div key={col} className="flex-1 text-sm truncate" role="cell">
            {col === 'symbol' ? (
              <span>{token.symbol}</span>
            ) : col === 'price' ? (
              <button className="bg-green-500 text-black px-2 py-1 rounded hover:bg-green-400 transition-colors">
                Buy ${formatNumber(token.price)}
              </button>
            ) : col === 'volume24h' ? (
              formatNumber(token.volume24h)
            ) : col === 'marketCap' ? (
              formatNumber(token.marketCap)
            ) : col === 'volumeMarketCapRatio' ? (
              formatRatio(token.volumeMarketCapRatio)
            ) : col === 'isVolumeHealthy' ? (
              formatBoolean(token.isVolumeHealthy)
            ) : col === 'pumpDumpRiskScore' ? (
              formatScore(token.pumpDumpRiskScore)
            ) : col === 'liquidityScore' ? (
              formatScore(token.liquidityScore)
            ) : col === 'walletDistributionScore' ? (
              formatScore(token.walletDistributionScore)
            ) : (
              '-'
            )}
          </div>
        ))}
      </div>
    );
  };

  return (
    <div className="p-4">
      <div className="mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between">
        <input
          type="text"
          placeholder="Search tokens..."
          value={searchQuery}
          onChange={handleSearchChange}
          className="w-full sm:max-w-xs p-2 border border-gray-600 rounded bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"
          aria-label="Search tokens"
        />
        <div className="mt-2 sm:mt-0 sm:ml-4 flex space-x-2">
          <select
            onChange={e => requestSort(e.target.value)}
            className="p-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
            aria-label="Sort tokens by"
          >
            <option value="">Sort By</option>
            <option value="marketCap">Market Cap</option>
            <option value="volume24h">Volume 24h</option>
            <option value="price">Price</option>
            <option value="liquidityScore">Liquidity Score</option>
            <option value="pumpDumpRiskScore">Pump/Dump Risk</option>
            <option value="walletDistributionScore">Wallet Dist Score</option>
          </select>
          <button
            onClick={showColumnModal}
            className="px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500"
            aria-label="Customize table columns"
          >
            Add/Remove Columns
          </button>
          <button
            onClick={onFilterClick}
            className="px-4 py-2 bg-yellow-500 text-black rounded hover:bg-yellow-400 transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500"
            aria-label="Open filter drawer"
          >
            Filter
          </button>
          <button
            onClick={showSortModal}
            className="px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500"
            aria-label="Open sort options"
          >
            <FaSort className="mr-1" /> Sort
          </button>
        </div>
      </div>
      <div className="overflow-x-auto">
        <div className="min-w-full">
          <div
            className="grid grid-cols-[minmax(80px,1fr)_minmax(100px,1fr)_minmax(100px,1fr)_minmax(100px,1fr)_minmax(120px,1fr)_minmax(100px,1fr)_minmax(120px,1fr)_minmax(120px,1fr)_minmax(120px,1fr)] gap-2 sticky top-0 bg-gray-900 z-10 p-2 text-white font-bold"
            role="row"
            aria-label="Table headers"
          >
            {columns.map(col => (
              <div
                key={col}
                className="text-sm truncate"
                role="columnheader"
                aria-sort={sortConfig?.key === col ? (sortConfig.direction === 'asc' ? 'ascending' : 'descending') : 'none'}
              >
                {col === 'symbol' ? 'Symbol' : 
                 col === 'volumeMarketCapRatio' ? 'Vol/Mkt Cap Ratio' : 
                 col === 'isVolumeHealthy' ? 'Health' : 
                 col === 'pumpDumpRiskScore' ? 'Pump/Dump Risk' : 
                 col === 'walletDistributionScore' ? 'Wallet Dist Score' : 
                 col.charAt(0).toUpperCase() + col.slice(1).replace(/([A-Z])/g, ' $1')}
              </div>
            ))}
          </div>
          <div role="grid" aria-label="Token data table">
            <FixedSizeList
              height={400}
              itemCount={sortedTokens.length}
              itemSize={50}
              width="100%"
            >
              {Row}
            </FixedSizeList>
          </div>
        </div>
      </div>
      {isColumnModalVisible && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50">
          <div className="bg-gray-800 w-full max-w-md p-4 rounded-t-lg">
            <h2 className="text-lg font-bold text-white mb-4">Customize Table Columns</h2>
            {[
              'symbol',
              'price',
              'volume24h',
              'marketCap',
              'volumeMarketCapRatio',
              'isVolumeHealthy',
              'pumpDumpRiskScore',
              'liquidityScore',
              'walletDistributionScore',
            ].map(key => (
              <div key={key} className="flex items-center mb-2">
                <input
                  type="checkbox"
                  checked={visibleColumns.includes(key)}
                  onChange={() => toggleColumn(key)}
                  className="mr-2 h-4 w-4 text-green-500 bg-gray-700 border-gray-600 rounded focus:ring-green-500"
                  id={`column-${key}`}
                  aria-label={`Toggle ${key} column`}
                />
                <label htmlFor={`column-${key}`} className="text-white">
                  {key === 'symbol' ? 'Symbol' : 
                   key === 'volumeMarketCapRatio' ? 'Vol/Mkt Cap Ratio' : 
                   key === 'isVolumeHealthy' ? 'Health' : 
                   key === 'pumpDumpRiskScore' ? 'Pump/Dump Risk' : 
                   key === 'walletDistributionScore' ? 'Wallet Dist Score' : 
                   key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1')}
                </label>
              </div>
            ))}
            <button
              onClick={handleColumnClose}
              className="w-full mt-4 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-400 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500"
              aria-label="Close column customization"
            >
              Done
            </button>
          </div>
        </div>
      )}
      {isSortModalVisible && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50">
          <div className="bg-gray-800 w-full max-w-md p-4 rounded-t-lg">
            <h2 className="text-lg font-bold text-white mb-4">Sort By</h2>
            {[
              'price',
              'marketCap',
              'volume24h',
              'volumeMarketCapRatio',
              'pumpDumpRiskScore',
              'liquidityScore',
              'walletDistributionScore',
            ].map(key => (
              <div key={key} className="mb-2">
                <button
                  onClick={() => requestSort(key)}
                  className="w-full text-left p-2 bg-gray-700 rounded hover:bg-gray-600 text-white flex justify-between focus:outline-none focus:ring-2 focus:ring-blue-500"
                  aria-label={`Sort by ${key}`}
                >
                  <span>{key === 'volumeMarketCapRatio' ? 'Vol/Mkt Cap Ratio' : 
                         key === 'isVolumeHealthy' ? 'Health' : 
                         key === 'pumpDumpRiskScore' ? 'Pump/Dump Risk' : 
                         key === 'walletDistributionScore' ? 'Wallet Dist Score' : 
                         key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1')}</span>
                  <span>{sortConfig?.key === key ? (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“') : ''}</span>
                </button>
              </div>
            ))}
            <button
              onClick={handleSortClose}
              className="w-full mt-4 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-400 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500"
              aria-label="Close sort options"
            >
              Done
            </button>
          </div>
        </div>
      )}
      <FilterDrawer isOpen={isFilterDrawerOpen} onClose={onFilterClose} />
    </div>
  );
});

export default TokenTable;
=== .\components\WelcomeScreen.tsx ===
import React, { useEffect, useState } from 'react';
import { motion } from 'framer-motion';
import localforage from 'localforage';

const WelcomeScreen: React.FC<{ onFinish: () => void }> = ({ onFinish }) => {
  const [show, setShow] = useState(false);

  useEffect(() => {
    const checkLastVisit = async () => {
      const lastVisit = await localforage.getItem<number>('lastVisit');
      const now = Date.now();
      const oneDay = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

      if (!lastVisit || now - lastVisit > oneDay) {
        setShow(true);
        await localforage.setItem('lastVisit', now);
      } else {
        onFinish();
      }
    };

    checkLastVisit();
  }, [onFinish]);

  if (!show) return null;

  return (
    <motion.div
      initial={{ opacity: 1 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      transition={{ duration: 1 }}
      style={{
        position: 'fixed',
        top: 0,
        left: 0,
        width: '100vw',
        height: '100vh',
        background: '#001529',
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        zIndex: 2000,
      }}
      onAnimationComplete={() => {
        setTimeout(() => {
          setShow(false);
          onFinish();
        }, 2000);
      }}
    >
      <motion.div
        initial={{ scale: 0 }}
        animate={{ scale: 1 }}
        transition={{ type: 'spring', stiffness: 260, damping: 20 }}
      >
        {/* Replace with your logo */}
        <div style={{ fontSize: 48, color: '#fff', fontWeight: 'bold' }}>
          Sunnalytics
        </div>
      </motion.div>
    </motion.div>
  );
};

export default WelcomeScreen;
=== .\hooks\useTokenData.ts ===
import { useEffect } from 'react';
   import useSWR from 'swr';
   import { useTokenStore } from '../stores/useTokenStore';

   interface Token {
     id: string;
     name: string;
     symbol: string;
     category: string;
     price?: number;
     marketCap?: number;
     volume24h?: number;
     transferVolume24h?: number;
     createdAt: string;
     updatedAt: string;
     volatilityScore24h?: number;
     fullyDilutedValuation?: number;
     volumeMarketCapRatio?: number;
     circulatingSupplyPercentage?: number;
     isVolumeHealthy?: boolean;
     isCirculatingSupplyGood?: boolean;
     potentialMultiplier?: number;
   }

   const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3001';
   const API_KEY = process.env.NEXT_PUBLIC_API_KEY;

   const fetcher = async (url: string) => {
     const headers: HeadersInit = {};
     if (API_KEY) {
       headers['Authorization'] = `Bearer ${API_KEY}`;
     }
     const res = await fetch(url, { headers });
     if (!res.ok) {
       throw new Error(`Failed to fetch: ${res.statusText}`);
     }
     const data = await res.json();
     return Array.isArray(data) ? data : [data];
   };

   export function useTokenData() {
     const { setTokens, setFilteredTokens, setLoading, setError, fetchTokens } = useTokenStore();

     const { data, error, isLoading } = useSWR<Token[]>(`${API_BASE_URL}/tokens`, fetcher, {
       revalidateOnFocus: false,
       revalidateOnReconnect: false,
     });

     useEffect(() => {
       setLoading(isLoading);
       if (error) {
         setError(error.message || 'An unknown error occurred');
       } else if (data) {
         setTokens(data);
         setFilteredTokens(data);
         setError(null);
       }
     }, [data, error, isLoading, setTokens, setFilteredTokens, setLoading, setError]);

     return { fetchTokens };
   }
=== .\pages\charts.tsx ===
import React from 'react';
import BottomNav from '../components/BottomNav';

export default function Charts() {
  return (
    <div className="min-h-screen flex flex-col pb-16 bg-gray-900 text-white">
      <header className="bg-gray-800 p-4">
        <h1 className="text-xl font-bold text-white">Charts</h1>
      </header>
      <main className="flex-1 p-4">
        <div className="text-gray-300">Charts Page - Coming Soon</div>
      </main>
      <BottomNav onFilterClick={() => {}} />
    </div>
  );
}
=== .\pages\index.tsx ===
import { useEffect, useState } from 'react';
import BottomNav from '../components/BottomNav';
import TokenTable from '../components/TokenTable';
import { useTokenStore } from '../stores/useTokenStore';
import { useTokenData } from '../hooks/useTokenData';
import TabbedFilters from '../components/TabbedFilters';

export default function Home() {
  const { loading, error } = useTokenStore();
  const { fetchTokens } = useTokenData();
  const [isFilterDrawerOpen, setIsFilterDrawerOpen] = useState(false);

  useEffect(() => {
    fetchTokens();
  }, [fetchTokens]);

  const handleFilterClick = () => {
    setIsFilterDrawerOpen(true);
  };

  const handleFilterClose = () => {
    setIsFilterDrawerOpen(false);
  };

  return (
    <div className="min-h-screen flex flex-col pb-safe-area-inset-bottom bg-gray-900 text-white">
      <main className="flex-1 p-4">
        <div className="flex justify-between items-center mb-4">
          <h1 className="text-2xl font-bold">Market</h1>
          <div className="text-sm text-gray-400">Portfolio</div>
        </div>
        <TabbedFilters />
        {loading && <p className="text-center text-gray-400">Loading tokens...</p>}
        {error && (
          <p className="text-center text-red-500">
            Error: {error}{' '}
            <button onClick={fetchTokens} className="text-blue-500 underline">
              Retry
            </button>
          </p>
        )}
        {!loading && !error && (
          <TokenTable
            isFilterDrawerOpen={isFilterDrawerOpen}
            onFilterClick={handleFilterClick}
            onFilterClose={handleFilterClose}
          />
        )}
      </main>
      <BottomNav onFilterClick={handleFilterClick} />
    </div>
  );
}
=== .\pages\settings.tsx ===
import { useEffect, useState } from 'react';
import BottomNav from '../components/BottomNav';
import localforage from 'localforage';

export default function Settings() {
  const [isMounted, setIsMounted] = useState(false);
  const [isDarkMode, setIsDarkMode] = useState(false);

  useEffect(() => {
    setIsMounted(true);
    localforage.getItem('darkMode').then(value => {
      const darkMode = value as boolean;
      setIsDarkMode(darkMode || false);
      if (darkMode) {
        document.documentElement.classList.add('dark');
      }
    });
  }, []);

  const toggleDarkMode = () => {
    const newDarkMode = !isDarkMode;
    setIsDarkMode(newDarkMode);
    localforage.setItem('darkMode', newDarkMode);
    if (newDarkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  };

  const handleReset = () => {
    localforage.clear();
    setIsDarkMode(false);
    document.documentElement.classList.remove('dark');
  };

  if (!isMounted) return null;

  return (
    <div className="min-h-screen flex flex-col pb-16">
      <main className="flex-1 p-4">
        <h1 className="text-2xl font-bold mb-4">Settings</h1>
        <div className="mb-4 flex items-center justify-between">
          <span className="text-lg">Dark Mode</span>
          <label className="relative inline-flex items-center cursor-pointer">
            <input
              type="checkbox"
              checked={isDarkMode}
              onChange={toggleDarkMode}
              className="sr-only"
            />
            <div
              className={`w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-700 ${
                isDarkMode ? 'bg-blue-600' : ''
              }`}
            >
              <div
                className={`absolute w-5 h-5 bg-white rounded-full transition-transform duration-200 ease-in-out ${
                  isDarkMode ? 'translate-x-5' : 'translate-x-0'
                }`}
              ></div>
            </div>
          </label>
        </div>
        <button
          onClick={handleReset}
          className="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors"
        >
          Reset All Settings
        </button>
      </main>
      <BottomNav />
    </div>
  );
}
=== .\pages\welcome.tsx ===
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import localforage from 'localforage';

export default function Welcome() {
  const router = useRouter();

  useEffect(() => {
    localforage.getItem('welcomeScreenSeen').then(value => {
      if (value) {
        router.push('/');
      }
    });
  }, [router]);

  const handleContinue = () => {
    localforage.setItem('welcomeScreenSeen', true);
    router.push('/');
  };

  return (
    <div className="min-h-screen flex flex-col justify-center items-center bg-gray-100 p-4">
      <h1 className="text-3xl font-bold mb-4">Welcome to Sunnalytics</h1>
      <p className="text-lg text-gray-600 mb-6 text-center">
        Your go-to platform for token analytics and insights.
      </p>
      <button
        onClick={handleContinue}
        className="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
      >
        Continue
      </button>
    </div>
  );
}
=== .\pages\_app.tsx ===
import '../styles/globals.css';
import type { AppProps } from 'next/app';
import { inter, robotoMono } from '../utils/fonts';
import Head from 'next/head';
import { useState, useEffect } from 'react';
import WelcomeScreen from '../components/WelcomeScreen';

export default function App({ Component, pageProps }: AppProps) {
  const [showWelcome, setShowWelcome] = useState(true);
  const INACTIVITY_THRESHOLD = 10 * 60 * 1000; // 10 minutes in milliseconds

  useEffect(() => {
    const lastActive = localStorage.getItem('lastActive');
    const now = new Date().getTime();

    if (lastActive) {
      const lastActiveTime = parseInt(lastActive, 10);
      const timeSinceLastActive = now - lastActiveTime;

      // Show welcome screen if inactive for more than INACTIVITY_THRESHOLD
      if (timeSinceLastActive > INACTIVITY_THRESHOLD) {
        setShowWelcome(true);
      } else {
        setShowWelcome(false);
      }
    } else {
      // First visit or no stored timestamp
      localStorage.setItem('lastActive', now.toString());
      setShowWelcome(true);
    }

    // Update last active timestamp when the app is interacted with
    const handleActivity = () => {
      localStorage.setItem('lastActive', now.toString());
    };

    window.addEventListener('mousemove', handleActivity);
    window.addEventListener('keydown', handleActivity);
    window.addEventListener('scroll', handleActivity);

    return () => {
      window.removeEventListener('mousemove', handleActivity);
      window.removeEventListener('keydown', handleActivity);
      window.removeEventListener('scroll', handleActivity);
    };
  }, []);

  const handleWelcomeFinish = () => {
    setShowWelcome(false);
  };

  return (
    <div className={`${inter.variable} ${robotoMono.variable}`}>
      <Head>
        <title>Sunnalytics</title>
        <meta name="description" content="Sunnalytics - Token Analytics Platform" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="theme-color" content="#111827" />
        <link rel="icon" href="/favicon.ico" sizes="any" />
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
        <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
        <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192" />
        <link rel="icon" type="image/png" href="/android-chrome-512x512.png" sizes="512x512" />
        <link rel="manifest" href="/site.webmanifest" />
      </Head>
      {showWelcome && <WelcomeScreen onFinish={handleWelcomeFinish} />}
      <Component {...pageProps} />
    </div>
  );
}
=== .\stores\useTokenStore.ts ===
import { create } from 'zustand';
import localforage from 'localforage';
import { persist, createJSONStorage } from 'zustand/middleware';

interface Token {
  name: string;
  symbol: string;
  category: string;
  marketCap?: number;
  volume24h?: number;
  price?: number;
  transferVolume24h?: number;
  fullyDilutedValuation?: number;
  volumeMarketCapRatio?: number;
  circulatingSupplyPercentage?: number;
  isVolumeHealthy?: boolean;
  isCirculatingSupplyGood?: boolean;
  potentialMultiplier?: number;
  rank?: number;
  liquidityScore?: number;
  pumpDumpRiskScore?: number;
  walletDistributionScore?: number;
  stats?: {
    priceChange24h?: number;
    volatilityScore24h?: number;
    liquidityScore?: number;
  };
}

interface TokenState {
  tokens: Token[];
  filteredTokens: Token[];
  loading: boolean;
  error: string | null;
  setTokens: (tokens: Token[]) => void;
  setFilteredTokens: (tokens: Token[]) => void;
  setLoading: (loading: boolean) => void;
  setError: (error: string | null) => void;
  fetchTokens: () => void; // Kept for manual triggering if needed
}

export const useTokenStore = create<TokenState>()(
  persist(
    (set) => ({
      tokens: [],
      filteredTokens: [],
      loading: false,
      error: null,
      setTokens: (tokens: Token[]) => set({ tokens }),
      setFilteredTokens: (tokens: Token[]) => set({ filteredTokens: tokens }),
      setLoading: (loading: boolean) => set({ loading }),
      setError: (error: string | null) => set({ error }),
      fetchTokens: () => {}, // Placeholder, will be triggered by useTokenData
    }),
    {
      name: 'token-store',
      storage: createJSONStorage(() => localforage),
    }
  )
);
=== .\styles\globals.css ===
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --max-width: 1100px;
  --border-radius: 12px;
  --font-mono: var(--font-roboto-mono), ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono',
    'Roboto Mono', 'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro',
    'Fira Mono', 'Droid Sans Mono', 'Courier New', monospace;
}

* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html,
body {
  max-width: 100vw;
  overflow-x: hidden;
  font-family: var(--font-inter), system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 
    'Helvetica Neue', Arial, sans-serif;
}

a {
  color: inherit;
  text-decoration: none;
}

@media (prefers-color-scheme: dark) {
  html {
    color-scheme: dark;
  }
}
=== .\utils\api.ts ===
import useSWR from 'swr';

const API_BASE_URL = 'https://sunnalytics-backend.onrender.com';

const fetcher = async (url: string) => {
  const res = await fetch(url);
  if (!res.ok) {
    const error = new Error('An error occurred while fetching the data.');
    throw error;
  }
  return res.json();
};

export function useTokens(category?: string) {
  const url = category
    ? `${API_BASE_URL}/tokens?category=${category}`
    : `${API_BASE_URL}/tokens`;
  const { data, error, isLoading } = useSWR(url, fetcher, {
    refreshInterval: 60000, // Refresh every minute
    revalidateOnFocus: false,
  });
  return { tokens: data, error, isLoading };
}

export async function refreshTokens() {
  const res = await fetch(`${API_BASE_URL}/tokens/refresh`, { method: 'POST' });
  if (!res.ok) {
    throw new Error('Failed to refresh tokens');
  }
  return res.json();
}

=== .\utils\fonts.ts ===
import { Inter, Roboto_Mono } from 'next/font/google';

export const inter = Inter({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-inter',
});

export const robotoMono = Roboto_Mono({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-roboto-mono',
});
=== .\utils\tokenStats.ts ===
export interface TokenStats {
  priceChange24h: number;
  volatilityScore24h: number;
  liquidityScore: number;
  transferVolume24h: number;
}

export function calculateTokenStats(data: {
  price: number | null;
  marketCap: number | null;
  volume24h: number | null;
  circulatingSupply: number | null;
  totalSupply: number | null;
  priceChange24h?: number | null;
  transferAmount?: number;
}): TokenStats {
  const { price, marketCap, volume24h, circulatingSupply, priceChange24h, transferAmount } = data;

  const change24h = priceChange24h ?? 0;
  const volatility = volume24h && marketCap ? (volume24h / marketCap) : 0;
  const liquidityScore = volume24h && circulatingSupply ? volume24h / circulatingSupply : 0;
  const transferVol24h = transferAmount ?? 0;

  return {
    priceChange24h: Number(change24h.toFixed(2)),
    volatilityScore24h: Number(volatility.toFixed(2)),
    liquidityScore: Number(liquidityScore.toFixed(2)),
    transferVolume24h: Number(transferVol24h.toFixed(2)),
  };
}
